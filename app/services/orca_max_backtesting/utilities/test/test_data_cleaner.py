import unittest

from orcaven.algorithm.abc_validator.utilities.clean_data import DataCleaner


class TestDataProcessor(unittest.TestCase):
    def setUp(self):
        self.data = """
20240707 220254 6680000;20595.5;20594.5;20593.75;1
20240707 220254 6680000;20594.5;20593.75;20594.5;1
20240707 220255 8520000;20594.5;20593.75;20594.5;2
20240707 220256 3920000;20593.75;20593.75;20594.5;1
20240707 220258 1160000;20594.5;20593.75;20594.5;1
20240707 220301 5600000;20595.75;20595.25;20595.75;1
20240707 220301 5600000;20596;20595.5;20596;3
20240707 220301 5600000;20596;20595.5;20596;1
20240707 220301 7320000;20596;20596;20597.25;1
20240707 220302 7880000;20597.5;20596.25;20597.5;1
20240707 220302 7880000;20597.75;20596.75;20597.75;1
20240707 220302 8880000;20596.75;20596.75;20597.75;1
20240707 220303 9320000;20597.75;20596.75;20597.75;1
20240707 220304 0320000;20596.75;20596.75;20597.5;1
20240707 220304 0320000;20596.5;20596.5;20597.25;1
20240707 220307 0840000;20597.25;20596.25;20597.25;1
20240707 220307 0840000;20597.25;20596.25;20597.25;1
20240707 220308 1960000;20597.5;20596.5;20597.5;1
20240707 220308 1960000;20597.5;20596.5;20597.5;1
20240707 220308 1960000;20597.75;20596.5;20597.75;1
20240707 220308 4720000;20596.75;20596.75;20598;1"""

    def test_filter_data(self):
        expected_output = """20240707 220254 6680000;20593.75
20240707 220254 6680000;20594.5
20240707 220301 5600000;20595.75
20240707 220301 5600000;20596
20240707 220301 7320000;20597.25
20240707 220302 7880000;20597.5
20240707 220302 7880000;20597.75
20240707 220304 0320000;20597.5
20240707 220304 0320000;20597.25
20240707 220308 1960000;20597.5
20240707 220308 1960000;20597.75
20240707 220308 4720000;20598"""
        processor = DataCleaner(self.data, "")
        result = processor.filter_data()
        self.assertEqual(result, expected_output)


if __name__ == "__main__":
    unittest.main()
